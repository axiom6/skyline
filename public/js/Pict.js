// Generated by CoffeeScript 1.6.3
(function() {
  var $, Pict;

  $ = Util.requireModule('jquery', 'skyline');

  Pict = (function() {
    window.Pict = Pict;

    Pict.page = function(title, prev, curr, next) {
      var pict;
      pict = new Pict();
      Util.ready(function() {
        pict.roomPageHtml(title, prev, next);
        pict.createFoto('RoomSlides', curr);
      });
    };

    function Pict() {
      this.slide = null;
    }

    Pict.prototype.roomPageHtml = function(title, prev, next) {
      var htm, nextPage, prevPage;
      prevPage = " '" + prev + ".html' ";
      nextPage = " '" + next + ".html' ";
      htm = "<button class=\"home\" onclick=\"Util.toPage('../guest.html');\">Home Page</button>\n<button class=\"prev\" onclick=\"Util.toPage(" + prevPage + ");\"    >Prev Cabin</button>\n<span   class=\"room\">" + title + "</span>\n<button class=\"next\" onclick=\"Util.toPage(" + nextPage + ");\"    >Next Cabin</button>";
      $('#top').append(htm);
    };

    Pict.prototype.createFoto = function(parentId, roomId) {
      var $par, h, id, images, r, url, w,
        _this = this;
      $par = $('#' + parentId);
      w = $par.width();
      h = $par.height() - 40;
      r = w > 40 && h > 40 ? w / h : void 0;
      id = parentId === 'RoomSlides' ? "slideroom" : "slideshow";
      Util.log('Pict.createFoto()', {
        w: w,
        h: h,
        r: r
      });
      $par.empty();
      $('.HomeSee').width(w);
      $('.ViewSee').width(w);
      if (id === "slideroom") {
        w *= 0.8;
      }
      images = function(Img) {
        var dir, htm, pic, _i, _len, _ref;
        htm = "<div id=\"" + id + "\" class=\"fotorama\"  data-allowfullscreen=\"true\" ";
        htm += "data-minheight=\"" + h + "\" data-maxheight=\"" + h + "\" data-ratio=\"" + r + "\" ";
        htm += "data-minwidth =\"" + w + "\" data-maxwidth =\"" + w + "\" ";
        htm += ">";
        dir = Img[roomId].dir;
        _ref = Img[roomId]['pics'];
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          pic = _ref[_i];
          htm += _this.fotoImg(pic, dir);
        }
        htm += "</div>";
        $par.append(htm);
        return $('#' + ("" + id)).fotorama();
      };
      url = parentId === 'RoomSlides' ? '../img/img.json' : 'img/img.json';
      $.getJSON(url, images);
    };

    Pict.prototype.fotoImg = function(pic, dir) {
      var htm;
      htm = "<img src=\"" + dir + pic.src + "\"  ";
      if (Util.isStr(pic.name)) {
        htm += "data-caption=\"" + pic.name + "\" ";
      }
      htm += ">";
      return htm;
    };

    Pict.prototype.createVid = function(parentId) {
      var $par, h, htm, r, w;
      $par = $('#' + parentId);
      w = Math.max($par.width(), 640);
      h = Math.max($par.height(), 640);
      r = w > 40 && h > 40 ? w / h : 1.0;
      $par.empty();
      htm = "<div id=\"ViewVid\">\n  <iframe id=\"VideoView\" title=\"Skyline Cottages\" class=\"youtube-player\"\n    src=\"https://www.youtube.com/embed/MsUfGee7kYY\" frameborder=\"0\" allowFullScreen></iframe>\n</div>";
      return $par.append(htm);
    };

    Pict.prototype.createFotoVid = function(parentId) {
      var $par, h, htm, r, w;
      $par = $('#' + parentId);
      w = Math.max($par.width(), 640);
      h = Math.max($par.height(), 640);
      r = w > 40 && h > 40 ? w / h : 1.0;
      $par.empty();
      htm = "<div id=\"slideshow\" class=\"fotorama\"  data-allowfullscreen=\"true\" ";
      htm += "data-maxwidth=\"" + w + "\"   data-maxheight=\"" + h + "\"   data-ratio=\"" + r + "\" ";
      htm += "data-minwidth=\"" + 640 + "\" data-minheight=\"" + 640 + "\" >";
      htm += "<a href=\"https://www.youtube.com/embed/MsUfGee7kYY\" data-video=\"true\"><img class=\"SkyVid\" src=\"img/site/youtube.png\"></a>";
      htm += "</div>";
      return $par.append(htm);
    };

    return Pict;

  })();

}).call(this);
